--- 
# **INTRODUCTION**  
---  
This directory contains modules, jupyter notebooks, and python scripts for pre-processing netCDF forcing datasets. Specifically, this is designed to generate 3-hourly forcing files required by SnowModel over CONUS and saves these files in a monthly format. This is specifically applicable to the WRF netCDF files generated by NCAR WRF 404 dataset (https://rda.ucar.edu/datasets/ds559.0/). Additional changes will need to be made to make this more generic for other netCDF files. The python scripts and jupyter notebooks use a Object-Oriented python approach.  

FILE STRUCTURE:  
sm_wrf_preprocess/ 
- env/
    - `geospatial.yml`
- json/
    - `plotting_data.json`
- load_data/
    - `input.py`
    - `user_inputs_load.py`
    - `user_inputs.py`
- process_data/
    - `aggregation.py`
`process_vars.py`   
`README.md`    

## **REQUIREMENTS** 
1. **Install Python Environment**
    - A list of the required libraries needed to run the jupyter notebooks and python scripts can be viewed in the `./env/geospatial.yml` file. To install these libraries via terminal commands, change directories to env/ and run the following terminal command:  
    `conda env create -f geospatial.yml`  
    `conda activate geospatial` 
2. **Download WRF Data**
    - Prior to processing the netcdf WRF files for SnowModel use, daily WRF files need to be downloaded using the script `../../../data_download/wrf_404_download.py`
3. **Change User Inputs**
    - Update filepaths in `./load_data/user_inputs.py` to reflect the system filepaths and desired output.
4. **Run Processing Script**
    - Run python script `process_vars.py` ***TWO*** times to process all variables.
    - For processing entire CONUS dataset **400GB** of memory has been previously used. Therefore, submitting this as a job on supercomputing resources is likely **required**!

## **LIMITATIONS**
    - This workflow has been tested for 3-hrly CONUS Parallel SnowModel runs on specific computing infraestructure. Therefore, it will likely need to be adapted to the needs of the user. 

## **MAINTAINERS** 
Ross Mower rossamower@ucar.edu  
